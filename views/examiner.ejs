<html lang="en">
<!--HEADER-->
<%- include('layouts/header'); -%>
<body class="d-flex flex-column vh-100">
<!--NAVBAR-->
<%- include('layouts/navbar') -%>
<!--MAIN CONTENT-->
<header class="bg-dark text-light text-center flex-grow-1">
  <div class="container d-flex flex-column justify-content-center align-items-center py-5">
    <div class="row align-self-start text-start mb-3">
      <div class="col-12">
        <h3 class="text-light text-capitalize"><%= currentView ? `class ${currentView} ` : 'All '; %>Appointments</h3>
        <p class="text-secondary">Below are
          <%= currentView && currentView !== 'all' ? `the class ${currentView.toUpperCase()} ` : 'all the'; %>
          test appointments</p>
      </div>
    </div>
    <% if (typeof formErrors === 'object' && formErrors.length > 0) { %>
      <div class="row text-start mb-3">
        <div class="col-12">
          <div id="feedback-wrapper" class="w-100 text-start py-2 px-3 bg-light rounded">
            <% formErrors.forEach(e=> { %>
              <span class="mb-1 text-danger"><i
                    class="fa-solid fa-exclamation-triangle me-2"></i><%= e; %></span><br>
            <% }); %>
          </div>
        </div>
      </div>
    <% } %>
    <form class="text-dark w-100" method="post" action="/examiner/show" id="examinerForm">
      <div class="row mb-3">
        <div class="col-12 col-md-6 mb-3">
          <div class="input-group">
            <label for="testType" class="input-group-text">Test Type</label>
            <select id="testType" name="testType" class="form-select form-select-lg">
              <option value="all">All Tests</option>
              <option value="g2">G2 Test</option>
              <option value="g">G Test</option>
            </select>
          </div>
        </div>
        <div class="col-12 col-md-6 text-light text-start mb-3">
          <button type="submit" class="btn btn-lg btn-warning">Show</button>
        </div>
      </div>
    </form>
    <div class="w-100">
      <div class="row">
        <div class="col-12">
          <div class="table-responsive">
            <table class="table table-stripped table-light table-bordered mx-auto">
              <thead class="table-dark fw-medium fs-5">
              <tr>
                <td>#</td>
                <td>Email</td>
                <td>Appointment</td>
                <td>Car</td>
              </tr>
              </thead>
              <tbody id="appointmentDetails">
              <% if (typeof bookings === 'object' && bookings.length > 0){ %>
                <% bookings.forEach((bo, dex)=> { %>
                  <tr>
                    <td><%= (dex + 1).toString() %></td>
                    <td><%= bo.email %></td>
                    <td><%= new Date(bo.bookingDate).toLocaleDateString() %> <%= new Date(bo.bookingDate).toLocaleTimeString() %></td>
                    <td><%= bo.car.plateNo %> [ <%= bo.car.make %> <%= bo.car.model %> <%= bo.car.year %> ]</td>
                  </tr>
                  <tr>
                    <td colspan="4">
                      <form class="text-dark w-100" method="post" action="/examiner/update" id="examinerUpdateForm">
                        <table class="table table-striped table-bordered table-light">
                          <thead class="table-dark">
                          <tr>
                            <td>Comments</td>
                            <td>Passed</td>
                            <td>Update</td>
                          </tr>
                          </thead>
                          <tbody>
                          <tr>
                            <td class="w-75">
                              <div class="row">
                                <div class="col-12 col-lg-6 mb-3">
                                  <div class="d-flex justify-content-start align-items-start">
                                    <div class="form-floating flex-grow-1">
                                      <input type="text" class="form-control" id="commentInput"
                                             name="commentInput"
                                             placeholder="Add Comment">
                                      <label for="commentInput">Add Comment</label>
                                    </div>
                                  </div>
                                </div>
                                <div class="col-12 col-lg-6 mt-1 mb-3">
                                  <% bo.comments.forEach(c=>{ %>
                                    <div class="row">
                                      <div class="col-auto"><i class="fa-solid fa-comments text-info"></i></div>
                                      <div class="col-auto"><%= c %></div>
                                    </div>
                                  <% }) %>
                                </div>
                              </div>
                            </td>
                            <td>
                              <div class="row">
                                <div class="col-12">
                                  <div class="form-check form-switch">
                                    <input type="checkbox" class="form-check-input" name="passCheck"
                                           id="passCheck" <%= bo.passed ? 'checked' : '' %> aria-label="..." />
                                  </div>
                                </div>
                              </div>
                            </td>
                            <td>
                              <button class="btn btn-dark" name="updateBtn" value="<%= bo.id %>">Save</button>
                            </td>
                          </tr>
                          </tbody>
                        </table>
                      </form>
                    </td>
                  </tr>
                <% }) %>
              <% } %>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>
</header>
<!--FOOTER-->
<%- include('layouts/footer') -%>
</body>
</html>